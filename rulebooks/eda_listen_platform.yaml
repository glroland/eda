- name: Read messages from a kafka topic and act on them
  hosts: localhost 

  sources:   
    - ansible.eda.kafka:
        host: tools.home.glroland.com
        port: 9092
        topic: eda
        offset: earliest

  rules:
    - name: receive event and kickoff automation template
      condition: event.body != ''
      action:
        run_job_template:
          name: eda_event
          organization: Default
          job_args: 
            extra_vars: 
              foo: "BAR"
              eda_event_body: "{{ event }}"
              body: event.body

    - name: receive event and kickoff automation workflow
      condition: event.body != ''
      action:
        run_workflow_template:
          name: eda_wf_event
          organization: Default
          job_args: 
            extra_vars: 
              foo: "BAR"
              eda_event_body: "{{ event }}"
              body: event.body
